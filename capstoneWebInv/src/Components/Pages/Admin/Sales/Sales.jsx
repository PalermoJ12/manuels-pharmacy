import React, { useState, useEffect } from "react";
import axios from "axios";
import moment from "moment";
import style from "./Sales.module.css";
import { BiSolidSave } from "react-icons/bi";

import { DatePicker, ConfigProvider } from "antd";
const { RangePicker } = DatePicker;
import apiUrl from "../../../Config/config";
import { toast } from "react-toastify";

import { Button, Modal } from "react-bootstrap";
import { TbDeviceIpadCancel } from "react-icons/tb";

import Dropdown from "react-bootstrap/Dropdown";

import ReactToPrint from "react-to-print";
import logo from "../../../assets/M-B.png";

import ExcelJS from "exceljs";

const pageStyle = `
@page {
  size: 10mm 10mm;
};

@media all{
  .pageBreak {
    display: none
  }
};

@media print {
  .pageBreak{
    page-break-before: always;
  }
}
`;

var logoBase64 =
  "data:image/png;base64,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";
const Sales = () => {
  const ref = React.useRef();

  const printRefI = React.useRef();
  const [inputValueI, setInputValueI] = useState("");

  const handleChangeI = (event) => {
    setInputValueI(event.target.value);
  };

  const handleConfirmI = () => {
    if (inputValueI.trim() === "") {
      toast.error("Enter a name in prepared by.");
    } else {
      printRefI.current();
    }
  };

  // Function to validate whether the input is empty
  const isInputEmptyI = inputValueI.trim() === "";

  const printRefS = React.useRef();
  const [inputValueS, setInputValueS] = useState("");

  const handleChangeS = (event) => {
    setInputValueS(event.target.value);
  };

  const handleConfirmS = () => {
    if (inputValueS.trim() === "") {
      toast.error("Enter a name in prepared by.");
    } else {
      printRefS.current();
    }
  };

  // Function to validate whether the input is empty
  const isInputEmptyS = inputValueS.trim() === "";

  const printRefP = React.useRef();
  const [inputValueP, setInputValueP] = useState("");

  const handleChangeP = (event) => {
    setInputValueP(event.target.value);
  };

  const handleConfirmP = () => {
    if (inputValueP.trim() === "") {
      toast.error("Enter a name in prepared by.");
    } else {
      printRefP.current();
    }
  };

  // Function to validate whether the input is empty
  const isInputEmptyP = inputValueP.trim() === "";

  /*MODALS*/
  const [showModalSales, setModalSales] = useState(false);
  const handleModalSalesOpen = () => {
    setModalSales(true);
  };
  const handleModalSalesClose = () => {
    setModalSales(false);
  };

  const [showModalInventory, setModalInventory] = useState(false);
  const handleModalInventoryOpen = () => {
    setModalInventory(true);
  };
  const handleModalInventoryClose = () => {
    setModalInventory(false);
  };

  const [showModalProduct, setModalProduct] = useState(false);
  const handleModalProductOpen = () => {
    setModalProduct(true);
  };
  const handleModalProductClose = () => {
    setModalProduct(false);
  };

  const dpWidth = {
    width: "100%",
  };

  const [isYearPickerActive, setIsYearPickerActive] = useState(true);
  const [isRangePickerActive, setIsRangePickerActive] = useState(true);

  const [inventoryReturn, setInventoryReturn] = useState([]);
  const [totalSaleInv, setTotalSaleInv] = useState(0);
  const [searchQueryInv, setSearchQueryInv] = useState("");

  const filteredSalesInv = inventoryReturn.filter((sale) => {
    const searchValue = searchQueryInv.toLowerCase();
    const containsSearchQuery = (value) =>
      String(value).toLowerCase().includes(searchValue);

    return (
      containsSearchQuery(sale.dateSale) ||
      containsSearchQuery(sale.cash) ||
      containsSearchQuery(sale.totalSale) ||
      containsSearchQuery(sale.saleId) ||
      containsSearchQuery(sale.prodName) ||
      containsSearchQuery(sale.prodDetails) ||
      containsSearchQuery(sale.batchNumber)
    );
  });

  const [handleRangeInv, setRangeInv] = useState("");

  const handleYearPickerChange = (date, dateString) => {
    if (dateString) {
      setRangeInv(dateString);
      fetchInventoryDataByYear(dateString);
    } else {
      setInventoryReturn([]);
    }
  };

  //inventory
  const handleRangePickerChange = (date, dateString) => {
    if (dateString) {
      setRangeInv(`${dateString[0]} - ${dateString[1]}`);
      fetchInventoryDataByRange(dateString[0], dateString[1]);
    } else {
      setInventoryReturn([]);
    }
  };

  const [salesReturn, setSalesReturn] = useState([]);
  const [totalSale, setTotalSale] = useState(0);
  const [searchQuery, setSearchQuery] = useState("");

  const filteredSales = salesReturn.filter((sale) => {
    const searchValue = searchQuery.toLowerCase();
    const containsSearchQuery = (value) =>
      String(value).toLowerCase().includes(searchValue);

    return (
      containsSearchQuery(sale.dateSale) ||
      containsSearchQuery(sale.cash) ||
      containsSearchQuery(sale.totalSale) ||
      containsSearchQuery(sale.saleId) ||
      containsSearchQuery(sale.prodName) ||
      containsSearchQuery(sale.prodDetails) ||
      containsSearchQuery(sale.batchNumber)
    );
  });

  // Calculate the sum of totalSale from filteredSales
  useEffect(() => {
    const sumTotalSale = filteredSales.reduce((total, sale) => {
      return total + parseFloat(sale.itemTotal);
    }, 0);

    // Format the totalSale to 2 decimal places and add commas for every 3 digits
    setTotalSale(
      sumTotalSale.toLocaleString("en-US", { minimumFractionDigits: 2 })
    );
  }, [filteredSales]);

  const [handleRange, setRange] = useState("");

  //sales
  const handleYearPickerChangeS = (date, dateString) => {
    if (dateString) {
      setRange(dateString);

      fetchSalesDataByYear(dateString);
    } else {
      setSalesReturn([]);
    }
  };

  //sales
  const handleRangePickerChangeS = (date, dateString) => {
    if (dateString) {
      setRange(`${dateString[0]} - ${dateString[1]}`);
      fetchSalesDataByRange(dateString[0], dateString[1]);
    } else {
      setSalesReturn([]);
    }
  };

  //inventory
  const handleMonthPickerChange = (date, dateString) => {
    if (dateString) {
      const formattedDate = moment(dateString, "MMMM, YYYY").format(
        "MMMM DD, YYYY"
      );
      setRangeInv(formattedDate);
      fetchInventoryDataByMonth(formattedDate);
    } else {
      setInventoryReturn([]);
    }
  };

  //sales
  const handleMonthPickerChangeS = (date, dateString) => {
    if (dateString) {
      const formattedDate = moment(dateString, "MMMM, YYYY").format(
        "MMMM DD, YYYY"
      );
      setRange(formattedDate);
      fetchSalesDataByMonth(formattedDate);
    } else {
      setSalesReturn([]);
    }
  };

  //inventory
  const handleWeekPickerChange = (date, dateString) => {
    if (dateString) {
      setRangeInv(dateString);
      fetchInventoryDataByWeek(dateString);
    } else {
      setInventoryReturn([]);
    }
  };

  //sales
  const handleWeekPickerChangeS = (date, dateString) => {
    if (dateString) {
      setRange(dateString);
      fetchSalesDataByWeek(dateString);
    } else {
      setSalesReturn([]);
    }
  };

  //inventory
  const handleDayPickerChange = (date, dateString) => {
    if (dateString) {
      setRangeInv(dateString);
      fetchInventoryDataByDay(dateString);
    } else {
      setInventoryReturn([]);
    }
  };

  //sales
  const handleDayPickerChangeS = (date, dateString) => {
    if (dateString) {
      setRange(dateString);
      fetchSalesDataByDay(dateString);
    } else {
      setSalesReturn([]);
    }
  };

  const fetchInventoryDataByRange = async (startDate, endDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByRange?startDate=${startDate}&endDate=${endDate}`
      );

      setInventoryReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchInventoryDataByYear = async (selectedYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByYear?year=${selectedYear}`
      );
      setInventoryReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchInventoryDataByMonth = async (selectedMonthYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByYearAndMonth?monthYear=${selectedMonthYear}`
      );
      console.log(response.data.Message);
      setInventoryReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchInventoryDataByWeek = async (selectedWeek) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByWeek?week=${selectedWeek}`
      );

      setInventoryReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchInventoryDataByDay = async (selectedDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByDay?selectedDate=${selectedDate}`
      );

      setInventoryReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchSalesDataByRange = async (startDate, endDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByRange?startDate=${startDate}&endDate=${endDate}`
      );

      setSalesReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchSalesDataByYear = async (selectedYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByYear?year=${selectedYear}`
      );
      setSalesReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchSalesDataByMonth = async (selectedMonthYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByYearAndMonth?monthYear=${selectedMonthYear}`
      );
      console.log(response.data.Message);
      setSalesReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchSalesDataByWeek = async (selectedWeek) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByWeek?week=${selectedWeek}`
      );

      setSalesReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchSalesDataByDay = async (selectedDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/getSalesByDay?selectedDate=${selectedDate}`
      );

      setSalesReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  //For purchase
  const [purchaseReturn, setPurchaseReturn] = useState([]);

  const [searchPurchase, setSearchPurchase] = useState("");
  const [purchaseTotal, setTotalPurchase] = useState(0);

  const filteredPurchase = purchaseReturn.filter((sale) => {
    const searchValue = searchPurchase.toLowerCase();
   
    const containsSearchQuery = (value) =>
      String(value).toLowerCase().includes(searchValue);

    return (
      containsSearchQuery(sale.purchase_id) ||
      containsSearchQuery(sale.prodName) ||
      containsSearchQuery(sale.prodDetails) ||
      containsSearchQuery(sale.batchNumber) ||
      containsSearchQuery(sale.receivedQty) ||
      containsSearchQuery(sale.prodUnitName) ||
      containsSearchQuery(sale.buyingPrice) ||
      containsSearchQuery(sale.itemTotal)
    );
  });

  // Calculate the sum of totalPrice from filteredPurchase
  useEffect(() => {
    const sumTotalPrice = filteredPurchase.reduce((total, sale) => {
      return total + parseFloat(sale.itemTotal);
    }, 0);

    setTotalPurchase(
      sumTotalPrice.toLocaleString("en-US", { minimumFractionDigits: 2 })
    ); // Format the totalPurchase to 2 decimal places
  }, [filteredPurchase]);

  const handleYearChange = (date, dateString) => {
    if (dateString) {
      setRange(dateString);

      fetchPurchaseDataByYear(dateString);
    } else {
      setPurchaseReturn([]);
    }
  };

  const handleRangeChange = (date, dateString) => {
    if (dateString) {
      const startDate = moment(dateString[0]).format("MMMM DD, YYYY");
      const endDate = moment(dateString[1]).format("MMMM DD, YYYY");
      setRange(`${startDate} - ${endDate}`);
      fetchPurchaseDataByRange(startDate, endDate);
    } else {
      setPurchaseReturn([]);
    }
  };

  const handleMonthChange = (date, dateString) => {
    if (dateString) {
      const formattedDate = moment(dateString, "MMMM, YYYY").format(
        "MMMM DD, YYYY"
      );
      setRange(formattedDate);
      fetchPurchaseDataByMonth(formattedDate);
    } else {
      setPurchaseReturn([]);
    }
  };

  const handleWeekChange = (date, dateString) => {
    if (dateString) {
      setRange(dateString);
      fetchPurchaseDataByWeek(dateString);
    } else {
      setPurchaseReturn([]);
    }
  };

  const handleDayChange = (date, dateString) => {
    if (dateString) {
      setRange(dateString);
      fetchPurchaseDataByDay(dateString);
    } else {
      setPurchaseReturn([]);
    }
  };

  const fetchPurchaseDataByRange = async (startDate, endDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/purchaseByDateRange?startDate=${startDate}&endDate=${endDate}`
      );
      setPurchaseReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchPurchaseDataByYear = async (selectedYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/purchaseByYear?year=${selectedYear}`
      );
      setPurchaseReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchPurchaseDataByMonth = async (selectedMonthYear) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/purchaseByYearAndMonth?monthYear=${selectedMonthYear}`
      );
      console.log(response.data.Message);
      setPurchaseReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchPurchaseDataByWeek = async (selectedWeek) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/purchaseByWeek?week=${selectedWeek}`
      );
      setPurchaseReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  const fetchPurchaseDataByDay = async (selectedDate) => {
    try {
      const response = await axios.get(
        `${apiUrl}/api/purchaseByDay?selectedDate=${selectedDate}`
      );
      setPurchaseReturn(response.data.Message);
    } catch (error) {
      console.error("Error fetching sales data:", error);
    }
  };

  //This is for purchase list receive form
  const formatDate = (dateStr) => {
    const options = { year: "numeric", month: "2-digit", day: "2-digit" };
    const [month, day, year] = new Date(dateStr)
      .toLocaleDateString(undefined, options)
      .split("/");
    return `${year}-${month}-${day}`;
  };

  // Create a function to consolidate rows with the same saleId
  const consolidateSales = (sales) => {
    const consolidatedSales = {};
    sales.forEach((sale) => {
      if (consolidatedSales[sale.saleId]) {
      } else {
        consolidatedSales[sale.saleId] = { ...sale };
      }
    });
    return Object.values(consolidatedSales);
  };

  // Consolidate the sales data
  const consolidatedSalesData = consolidateSales(filteredSales);

  /*INVENTORY REPORT EXCEL*/
  const exportExcelFileInv = () => {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Inventory Sheet");
    sheet.properties.defaultRowHeight = 20;

    const logo = workbook.addImage({
      base64: logoBase64,
      extension: "png",
    });

    // Add the image to the worksheet with the new location and size
    sheet.addImage(logo, {
      tl: { col: 0, row: 0.5 },
      ext: { width: 160, height: 60 },
    });

    // Merge cells from B1 to G3
    sheet.mergeCells("B1:G3");

    // Set the text "Inventory Report" in the merged cells
    const titleCell = sheet.getCell("B1");
    titleCell.value = "Inventory Report";
    titleCell.font = { bold: true, size: 24 };
    titleCell.alignment = { horizontal: "right", vertical: "middle" };

    sheet.mergeCells("A4:G4");
    // Set the text "Inventory Report" in the merged cells
    const dateCell = sheet.getCell("A4");
    dateCell.value = `Date Range: ${handleRangeInv}`;
    dateCell.font = { bold: false, size: 10 };
    dateCell.alignment = { horizontal: "left", vertical: "middle" };

    // Set the height of the merged cells
    const dateRangeRow = sheet.getRow(4); // You can choose any row within the merged range
    dateRangeRow.height = 20;

    // Set the height of the merged cells
    const mergedRow = sheet.getRow(1); // You can choose any row within the merged range
    mergedRow.height = 30; // Set the desired height

    const headerRow = sheet.getRow(5);
    headerRow.values = [
      "Product",
      "Initial Qty",
      "Purchased Qty",
      "Remaining Qty",
      "Price",
      "Total Price",
      "Date Purchased \n (yyyy/mm/dd)",
    ];
    headerRow.height = 30;
    headerRow.eachCell((cell) => {
      cell.fill = {
        type: "pattern",
        pattern: "solid",
        fgColor: { argb: "10451D" }, // Background color
      };
      cell.font = {
        color: { argb: "FFFFFF" }, // Font color
        bold: true,
      };
      cell.alignment = {
        horizontal: "center",
        vertical: "middle",
        wrapText: true,
      };
    });

    sheet.columns = [
      {
        key: "product",
        width: 30,
        style: { alignment: { wrapText: true } },
      },

      {
        key: "IniQty",
        width: 20,
      },

      {
        key: "PurQty",
        width: 20,
      },

      {
        key: "RemQty",
        width: 20,
      },

      {
        key: "price",
        width: 20,
      },

      {
        key: "TotPrice",
        width: 20,
      },

      {
        key: "datePur",
        width: 20,
      },
    ];

    if (filteredSalesInv && filteredSalesInv.length > 0) {
      filteredSalesInv.forEach((sale, index) => {
        const row = sheet.addRow({
          IniQty: sale.batchQty || "0",
          PurQty: sale.qty || "0",
          RemQty: sale.remainingQty || "0",
          price: sale.sellingPrice || "0",
          TotPrice: sale.itemTotal === 0 ? "Returned" : sale.itemTotal || "0",
          datePur: formatDate(sale.dateSale),
        });

        // Set Sale ID in the top cell and make it bold
        const saleIdCell = sheet.getCell(`A${row.number}`);
        saleIdCell.value = sale.saleId;
        saleIdCell.font = { bold: true };
        saleIdCell.alignment = { horizontal: "middle" };

        // Set Product Name and Product Details in the cell below Sale ID
        const productCell = sheet.getCell(`A${row.number + 1}`);
        productCell.value = `${sale.prodName} (${sale.prodDetails})`;
        productCell.alignment = {
          wrapText: true,
          vertical: "middle",
          horizontal: "middle",
        };

        // Calculate the height needed for the cell based on content length
        const contentLength = (sale.prodName + sale.prodDetails).length;
        const idealRowHeight = 20; // Set your preferred row height here
        const adjustedRowHeight = Math.max(
          idealRowHeight,
          Math.ceil(contentLength / 30) * 15
        ); // Adjust as needed

        // Set the adjusted row height
        sheet.getRow(row.number + 1).height = adjustedRowHeight;

        // Merge cells for Initial Qty in both top and bottom cells
        sheet.mergeCells(`B${row.number}:B${row.number + 1}`);
        const initialQtyCell = sheet.getCell(`B${row.number}`);
        initialQtyCell.value = sale.batchQty || "0";
        initialQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`C${row.number}:C${row.number + 1}`);
        const purQtyCell = sheet.getCell(`C${row.number}`);
        purQtyCell.value = sale.qty || "0";
        purQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`D${row.number}:D${row.number + 1}`);
        const remQtyCell = sheet.getCell(`D${row.number}`);
        remQtyCell.value = sale.remainingQty || "0";
        remQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`E${row.number}:E${row.number + 1}`);
        const priceQtyCell = sheet.getCell(`E${row.number}`);
        priceQtyCell.value = sale.sellingPrice || "0";
        priceQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`F${row.number}:F${row.number + 1}`);
        const totalQtyCell = sheet.getCell(`F${row.number}`);
        totalQtyCell.value = sale.itemTotal || "0";
        totalQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`G${row.number}:G${row.number + 1}`);
        const dateQtyCell = sheet.getCell(`G${row.number}`);
        dateQtyCell.value = formatDate(sale.dateSale) || "0";
        dateQtyCell.alignment = {
          horizontal: "center",
          vertical: "middle",
          wrapText: true,
        };
      });
    } else {
      console.error("No data available for export:", filteredSalesInv);
    }

    workbook.xlsx.writeBuffer().then((data) => {
      const blob = new Blob([data], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheet.sheet",
      });
      const url = window.URL.createObjectURL(blob);
      const anchor = document.createElement("a");
      anchor.href = url;
      anchor.download = "Inventory Report.xlsx";
      anchor.click();
      window.URL.revokeObjectURL(url);
    });
  };

  /*SALES REPORT EXCEL*/
  const exportExcelFileSales = () => {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Sales Sheet");
    sheet.properties.defaultRowHeight = 20;

    const logo = workbook.addImage({
      base64: logoBase64,
      extension: "png",
    });

    // Add the image to the worksheet with the new location and size
    sheet.addImage(logo, {
      tl: { col: 0, row: 0.5 },
      ext: { width: 160, height: 60 },
    });

    // Merge cells from B1 to G3
    sheet.mergeCells("B1:D3");

    // Set the text "Inventory Report" in the merged cells
    const titleCell = sheet.getCell("B1");
    titleCell.value = "Sales Report";
    titleCell.font = { bold: true, size: 24 };
    titleCell.alignment = { horizontal: "right", vertical: "middle" };

    sheet.mergeCells("A4:B4");
    // Set the text "Inventory Report" in the merged cells
    const dateCell = sheet.getCell("A4");
    dateCell.value = `Date Range: ${handleRange}`;
    dateCell.font = { bold: false, size: 10 };
    dateCell.alignment = { horizontal: "left", vertical: "middle" };

    sheet.mergeCells("C4:D4");
    // Set the text "Inventory Report" in the merged cells
    const totalCell = sheet.getCell("C4");
    totalCell.value = `Total Sales: ${totalSale}`;
    totalCell.font = { bold: false, size: 10 };
    totalCell.alignment = { horizontal: "right", vertical: "middle" };

    // Set the height of the merged cells
    const dateRangeRow = sheet.getRow(4); // You can choose any row within the merged range
    dateRangeRow.height = 20;

    // Set the height of the merged cells
    const mergedRow = sheet.getRow(1); // You can choose any row within the merged range
    mergedRow.height = 30; // Set the desired height

    const headerRow = sheet.getRow(5);
    headerRow.values = ["ID", "Cash", "Total Sales", "Date \n (yyyy/mm/dd)"];
    headerRow.height = 30;
    headerRow.eachCell((cell) => {
      cell.fill = {
        type: "pattern",
        pattern: "solid",
        fgColor: { argb: "10451D" }, // Background color
      };
      cell.font = {
        color: { argb: "FFFFFF" }, // Font color
        bold: true,
      };
      cell.alignment = {
        horizontal: "center",
        vertical: "middle",
        wrapText: true,
      };
    });

    sheet.columns = [
      {
        key: "id",
        width: 30,
        style: { alignment: { wrapText: true } },
      },

      {
        key: "cash",
        width: 20,
      },

      {
        key: "totalSales",
        width: 20,
      },

      {
        key: "Date",
        width: 20,
      },
    ];

    if (consolidatedSalesData && consolidatedSalesData.length > 0) {
      consolidatedSalesData.forEach((sale, index) => {
        const row = sheet.addRow({
          id: sale.saleId,
          cash: sale.cash,
          totalSales: sale.totalSale.toFixed(2),
          Date: formatDate(sale.dateSale),
        });

        row.eachCell((cell) => {
          cell.alignment = {
            horizontal: "center",
            vertical: "middle",
          };
        });
      });
    } else {
      console.error("No data available for export:", filteredSales);
    }

    workbook.xlsx.writeBuffer().then((data) => {
      const blob = new Blob([data], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheet.sheet",
      });
      const url = window.URL.createObjectURL(blob);
      const anchor = document.createElement("a");
      anchor.href = url;
      anchor.download = "Sales Report.xlsx";
      anchor.click();
      window.URL.revokeObjectURL(url);
    });
  };

  /*INVENTORY REPORT EXCEL*/
  const exportExcelFileProd = () => {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Product Sheet");
    sheet.properties.defaultRowHeight = 20;

    const logo = workbook.addImage({
      base64: logoBase64,
      extension: "png",
    });

    // Add the image to the worksheet with the new location and size
    sheet.addImage(logo, {
      tl: { col: 0, row: 0.5 },
      ext: { width: 160, height: 60 },
    });

    // Merge cells from B1 to G3
    sheet.mergeCells("B1:E3");

    // Set the text "Inventory Report" in the merged cells
    const titleCell = sheet.getCell("B1");
    titleCell.value = "Product Report";
    titleCell.font = { bold: true, size: 24 };
    titleCell.alignment = { horizontal: "right", vertical: "middle" };

    sheet.mergeCells("A4:C4");
    // Set the text "Inventory Report" in the merged cells
    const dateCell = sheet.getCell("A4");
    dateCell.value = `Date Range: ${handleRangeInv}`;
    dateCell.font = { bold: false, size: 10 };
    dateCell.alignment = { horizontal: "left", vertical: "middle" };

    sheet.mergeCells("D4:E4");
    // Set the text "Inventory Report" in the merged cells
    const totalCell = sheet.getCell("D4");
    totalCell.value = `Total Cost: ${purchaseTotal}`;
    totalCell.font = { bold: false, size: 10 };
    totalCell.alignment = { horizontal: "right", vertical: "middle" };

    // Set the height of the merged cells
    const mergedRow = sheet.getRow(1); // You can choose any row within the merged range
    mergedRow.height = 30; // Set the desired height

    const headerRow = sheet.getRow(5);
    headerRow.values = [
      "Product",
      "Qty",
      "Price",
      "Total Price",
      "Date Purchased \n (yyyy/mm/dd)",
    ];
    headerRow.height = 30;
    headerRow.eachCell((cell) => {
      cell.fill = {
        type: "pattern",
        pattern: "solid",
        fgColor: { argb: "10451D" }, // Background color
      };
      cell.font = {
        color: { argb: "FFFFFF" }, // Font color
        bold: true,
      };
      cell.alignment = {
        horizontal: "center",
        vertical: "middle",
        wrapText: true,
      };
    });

    sheet.columns = [
      {
        key: "product",
        width: 30,
        style: { alignment: { wrapText: true } },
      },

      {
        key: "qty",
        width: 20,
      },

      {
        key: "price",
        width: 20,
      },

      {
        key: "totalPrice",
        width: 20,
      },

      {
        key: "date",
        width: 20,
      },
    ];

    if (filteredPurchase && filteredPurchase.length > 0) {
      filteredPurchase.forEach((purchase, index) => {
       
        const row = sheet.addRow({
          qty: purchase.prodQtyWhole || "0",
          price: purchase.buyingPrice.toFixed(2) || "0",
          totalPrice: purchase.totalPrice || "0",
          date: formatDate(purchase.dateReq),
        });

        // Set Sale ID in the top cell and make it bold
        const saleIdCell = sheet.getCell(`A${row.number}`);
        saleIdCell.value = purchase.prodName;
        saleIdCell.font = { bold: true };
        saleIdCell.alignment = { horizontal: "middle" };

        // Set Product Name and Product Details in the cell below Sale ID
        const productCell = sheet.getCell(`A${row.number + 1}`);
        productCell.value = purchase.prodDetails;
        productCell.alignment = {
          wrapText: true,
          vertical: "middle",
          horizontal: "middle",
        };

        // Calculate the height needed for the cell based on content length
        const contentLength = purchase.prodDetails.length;
        const idealRowHeight = 20; // Set your preferred row height here
        const adjustedRowHeight = Math.max(
          idealRowHeight,
          Math.ceil(contentLength / 30) * 15
        ); // Adjust as needed

        // Set the adjusted row height
        sheet.getRow(row.number + 1).height = adjustedRowHeight;

        // Merge cells for Initial Qty in both top and bottom cells
        sheet.mergeCells(`B${row.number}:B${row.number + 1}`);
        const initialQtyCell = sheet.getCell(`B${row.number}`);
        initialQtyCell.value = `${purchase.receivedQty} - (${purchase.prodUnitName})` || "0";
        initialQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`C${row.number}:C${row.number + 1}`);
        const purQtyCell = sheet.getCell(`C${row.number}`);
        purQtyCell.value = purchase.buyingPrice.toFixed(2) || "0";
        purQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`D${row.number}:D${row.number + 1}`);
        const remQtyCell = sheet.getCell(`D${row.number}`);
        remQtyCell.value = purchase.itemTotal.toFixed(2) || "0";
        remQtyCell.alignment = { horizontal: "center", vertical: "middle" };

        sheet.mergeCells(`E${row.number}:E${row.number + 1}`);
        const priceQtyCell = sheet.getCell(`E${row.number}`);
        priceQtyCell.value = formatDate(purchase.dateReq) || "0";
        priceQtyCell.alignment = { horizontal: "center", vertical: "middle" };
      });
    } else {
      console.error("No data available for export:", filteredSales);
    }

    workbook.xlsx.writeBuffer().then((data) => {
      const blob = new Blob([data], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheet.sheet",
      });
      const url = window.URL.createObjectURL(blob);
      const anchor = document.createElement("a");
      anchor.href = url;
      anchor.download = "Product Report.xlsx";
      anchor.click();
      window.URL.revokeObjectURL(url);
    });
  };

  //Dropdown

  const [selectedOption, setSelectedOption] = useState("Inventory");

  const handleSelect = (eventKey) => {
    setSelectedOption(eventKey);
  };

  function inventoryRep() {
    return (
      <div className={`${style.container} container-fluid vh-100 mt-2`}>
        <div className="d-flex justify-content-between mt-3">
          <div className="ms-3">
            <h2 className={style.titlePage}>Inventory Report</h2>
          </div>

          <div className="me-2 d-flex">
            <div className="me-2">
              <button
                type="button"
                className="btn btn-success"
                onClick={() => {
                  filteredSalesInv.length > 0
                    ? exportExcelFileInv()
                    : toast.warning("Sorry, no inventory to export.");
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Export to Excel
              </button>
            </div>

            <div>
              <button
                type="button"
                className="btn btn-danger"
                onClick={() => {
                  {
                    filteredSalesInv.length > 0
                      ? handleModalInventoryOpen()
                      : toast.warning("Sorry, no inventory to save.");
                  }
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Save as PDF
              </button>
            </div>
          </div>
        </div>
        <hr />
        <div className="d-flex flex-column">
          <div className={`${style.column1} d-flex`}>
            <div className={`${style.dates}`}>
              <h6>Demand Date</h6>

              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <RangePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  style={dpWidth}
                  format="MMMM DD, YYYY"
                  onChange={handleRangePickerChange}
                  disabled={!isRangePickerActive}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Year</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="year"
                  style={dpWidth}
                  format="YYYY"
                  placeholder={["Choose Year"]}
                  onChange={handleYearPickerChange}
                  disabled={!isYearPickerActive}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Month</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="month"
                  style={dpWidth}
                  placeholder={["Choose Month"]}
                  format="MMMM, YYYY"
                  onChange={handleMonthPickerChange}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Week</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="week"
                  style={dpWidth}
                  placeholder={["Choose Week"]}
                  onChange={handleWeekPickerChange}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>By Day</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  style={dpWidth}
                  placeholder={["Choose Date"]}
                  format="MMMM DD, YYYY"
                  onChange={handleDayPickerChange}
                />
              </ConfigProvider>
            </div>
          </div>

          <div className="d-flex m-4">
            <div className="d-flex flex-column w-100">
              <div className="d-flex justify-content-center">
                <div className="w-100">
                  <input
                    type="text"
                    placeholder="Search"
                    value={searchQueryInv}
                    onChange={(e) => setSearchQueryInv(e.target.value)}
                    className={`${style.txtbox} form-control`}
                  />
                </div>
              </div>
              {filteredSalesInv.length > 0 ? (
                <div className={`${style["table-container"]} mt-2`}>
                  <table
                    className={`${style.tblInventory} table table-borderless table-striped`}
                  >
                    <thead>
                      <tr>
                        <th>Product</th>
                        <th>Initial Qty</th>
                        <th>Purchased Qty</th>
                        <th>Remaining Qty</th>
                        <th>Price</th>
                        <th>Total Price</th>
                        <th>
                          <div className="d-flex flex-column">
                            <label>Date Purchased</label>
                            <label className={style.lblmmddyyyy}>
                              (yyyy/mm/dd)
                            </label>
                          </div>
                        </th>
                      </tr>
                    </thead>

                    <tbody>
                      {filteredSalesInv.map((sale, index) => (
                        <tr key={index}>
                          <td>
                            <div className="d-flex flex-column">
                              <div>
                                <h6 style={{ fontWeight: "600" }}>
                                  {sale.saleId}
                                </h6>
                              </div>
                              <div>
                                {`${sale.prodName} (${sale.prodDetails})`}
                              </div>
                            </div>
                          </td>
                          <td>{sale.batchQty || "0"}</td>
                          <td>{sale.qty || "0"}</td>
                          <td>{sale.remainingQty || "0"}</td>
                          <td>₱{sale.sellingPrice || "0"}</td>
                          <td>
                          ₱{sale.itemTotal === 0
                              ? "Returned"
                              : sale.itemTotal || "0"}
                          </td>
                          <td>{formatDate(sale.dateSale)}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              ) : (
                <div className="d-flex flex-column justify-content-center align-items-center mt-4">
                  <TbDeviceIpadCancel size={100} color="#AAAAAA" />
                  <label style={{ color: "#AAAAAA" }}> No data found.</label>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }

  function salesRep() {
    return (
      <div className={`${style.container} container-fluid vh-100 mt-2`}>
        <div className="d-flex justify-content-between mt-3">
          <div className="ms-3">
            <h2 className={style.titlePage}>Sales Report</h2>
          </div>

          <div className="me-2 d-flex">
            <div className="me-2">
              <button
                type="button"
                className="btn btn-success"
                onClick={() => {
                  consolidatedSalesData.length > 0
                    ? exportExcelFileSales()
                    : toast.warning("Sorry, no sales to export.");
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Export to Excel
              </button>
            </div>

            <div>
              <button
                type="button"
                className="btn btn-danger"
                onClick={() => {
                  {
                    consolidatedSalesData.length > 0
                      ? handleModalSalesOpen()
                      : toast.warning("Sorry, no sales to save.");
                  }
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Save as PDF
              </button>
            </div>
          </div>
        </div>
        <hr />

        <div className="d-flex flex-column">
          <div className={`${style.column1} d-flex`}>
            <div className={`${style.dates}`}>
              <h6>Demand Date</h6>

              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <RangePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  style={dpWidth}
                  format="MMMM DD, YYYY"
                  onChange={handleRangePickerChangeS}
                  disabled={!isRangePickerActive}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Year</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="year"
                  style={dpWidth}
                  format="YYYY"
                  placeholder={["Choose Year"]}
                  onChange={handleYearPickerChangeS}
                  disabled={!isYearPickerActive}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Month</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="month"
                  style={dpWidth}
                  placeholder={["Choose Month"]}
                  format="MMMM, YYYY"
                  onChange={handleMonthPickerChangeS}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>Week</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  picker="week"
                  style={dpWidth}
                  placeholder={["Choose Week"]}
                  onChange={handleWeekPickerChangeS}
                />
              </ConfigProvider>
            </div>

            <div className={`${style.dates}`}>
              <h6>By Day</h6>
              <ConfigProvider
                theme={{
                  token: {
                    colorPrimary: "#10451D",
                  },
                }}
              >
                <DatePicker
                  className={style.customdp}
                  inputReadOnly
                  size="middle"
                  style={dpWidth}
                  placeholder={["Choose Date"]}
                  format="MMMM DD, YYYY"
                  onChange={handleDayPickerChangeS}
                />
              </ConfigProvider>
            </div>
          </div>

          <div className="d-flex m-4">
            <div className="d-flex flex-column w-100">
              <div className="d-flex justify-content-center">
                <div className="w-100">
                  <input
                    type="text"
                    placeholder="Search Id"
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    className={`${style.txtbox} form-control`}
                  />
                </div>
              </div>
              {consolidatedSalesData.length > 0 ? (
                <div className={`${style["table-container"]}`}>
                  <table
                    className={`${style.tblSale} table table-borderless table-striped`}
                  >
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Cash</th>
                        <th>Total Sales</th>
                        <th>
                          <div className="d-flex flex-column">
                            <label>Date</label>
                            <label className={style.lblmmddyyyy}>
                              (yyyy/mm/dd)
                            </label>
                          </div>
                        </th>
                      </tr>
                    </thead>

                    <tbody>
                      {consolidatedSalesData.map((sale, index) => (
                        <tr key={index}>
                          <td>{sale.saleId}</td>
                          <td>₱{sale.cash}</td>
                          <td>₱{sale.totalSale.toFixed(2)}</td>
                          <td>{formatDate(sale.dateSale)}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>

                  <br />
                </div>
              ) : (
                <div className="d-flex flex-column justify-content-center align-items-center mt-4">
                  <TbDeviceIpadCancel size={100} color="#AAAAAA" />
                  <label style={{ color: "#AAAAAA" }}> No data found.</label>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }

  function prodRep() {
    return (
      <div className={`${style.container} container-fluid vh-100 mt-2`}>
        <div className="d-flex justify-content-between mt-3">
          <div className="ms-3">
            <h2 className={style.titlePage}>Product Report</h2>
          </div>

          <div className="me-2 d-flex">
            <div className="me-2">
              <button
                type="button"
                className="btn btn-success"
                onClick={() => {
                  filteredPurchase.length > 0
                    ? exportExcelFileProd()
                    : toast.warning("Sorry, no product to export.");
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Export to Excel
              </button>
            </div>

            <div>
              <button
                type="button"
                className="btn btn-danger"
                onClick={() => {
                  {
                    filteredPurchase.length > 0
                      ? handleModalProductOpen()
                      : toast.warning("Sorry, no product report to save");
                  }
                }}
              >
                <span className={style.excelIcon}>
                  <BiSolidSave />
                </span>
                Save as PDF
              </button>
            </div>
          </div>
        </div>
        <hr />

        <div className={`${style.column1} d-flex`}>
          <div className={`${style.dates}`}>
            <h6>Demand Date</h6>

            <ConfigProvider
              theme={{
                token: {
                  colorPrimary: "#10451D",
                },
              }}
            >
              <RangePicker
                className={style.customdp}
                inputReadOnly
                size="middle"
                style={dpWidth}
                format="MMMM DD, YYYY"
                onChange={handleRangeChange}
                disabled={!isRangePickerActive}
              />
            </ConfigProvider>
          </div>

          <div className={`${style.dates}`}>
            <h6>Year</h6>
            <ConfigProvider
              theme={{
                token: {
                  colorPrimary: "#10451D",
                },
              }}
            >
              <DatePicker
                className={style.customdp}
                inputReadOnly
                size="middle"
                picker="year"
                style={dpWidth}
                format="YYYY"
                placeholder={["Choose Year"]}
                onChange={handleYearChange}
                disabled={!isYearPickerActive}
              />
            </ConfigProvider>
          </div>

          <div className={`${style.dates}`}>
            <h6>Month</h6>
            <ConfigProvider
              theme={{
                token: {
                  colorPrimary: "#10451D",
                },
              }}
            >
              <DatePicker
                className={style.customdp}
                inputReadOnly
                size="middle"
                picker="month"
                style={dpWidth}
                placeholder={["Choose Month"]}
                format="MMMM, YYYY"
                onChange={handleMonthChange}
              />
            </ConfigProvider>
          </div>

          <div className={`${style.dates}`}>
            <h6>Week</h6>
            <ConfigProvider
              theme={{
                token: {
                  colorPrimary: "#10451D",
                },
              }}
            >
              <DatePicker
                className={style.customdp}
                inputReadOnly
                size="middle"
                picker="week"
                style={dpWidth}
                placeholder={["Choose Week"]}
                onChange={handleWeekChange}
              />
            </ConfigProvider>
          </div>

          <div className={`${style.dates}`}>
            <h6>By Day</h6>
            <ConfigProvider
              theme={{
                token: {
                  colorPrimary: "#10451D",
                },
              }}
            >
              <DatePicker
                className={style.customdp}
                inputReadOnly
                size="middle"
                style={dpWidth}
                placeholder={["Choose Date"]}
                format="MMMM DD, YYYY"
                onChange={handleDayChange}
              />
            </ConfigProvider>
          </div>
        </div>
        <div className="d-flex m-4">
          <div className="d-flex flex-column w-100">
            <div className="d-flex justify-content-center">
              <div className="w-100">
                <input
                  type="text"
                  placeholder="Search"
                  value={searchPurchase}
                  onChange={(e) => setSearchPurchase(e.target.value)}
                  className={`${style.txtbox} form-control`}
                />
              </div>
            </div>
            {filteredPurchase.length > 0 ? (
              <div className={`${style["table-container"]} mt-2`}>
                <table
                  className={`${style.tblProduct} table caption-top table-borderless table-striped`}
                >
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Qty</th>
                      <th>Rem. Qty</th>
                      <th>Price</th>
                      <th>Total Price</th>
                      <th>
                        <div className="d-flex flex-column">
                          <label>Date Delivered</label>
                          <label className={style.lblmmddyyyy}>
                            (yyyy/mm/dd)
                          </label>
                        </div>
                      </th>
                    </tr>
                  </thead>

                  <tbody>
                    {filteredPurchase.map((purchase, index) => (
                      <tr key={index}>
                        <td>
                          <div className="d-flex flex-column">
                            <div className="d-flex align-items-center">
                            <h6 style={{ fontSize: "14px"}}>{purchase.purchase_id}</h6>
                            <h6 className="ms-2" style={{ fontSize: "12px", color: "#717171"}}><i>{purchase.batchNumber}</i></h6>
                            
                            </div>
                            <h6>{`${purchase.prodName} (${purchase.prodDetails})`}</h6>
                            
                          </div>
                        </td>
                        <td>{`${purchase.receivedQty} - (${purchase.prodUnitName})`}</td>
                        <td>{purchase.remainingQty }</td>

                        <td>₱{purchase.buyingPrice.toFixed(2)}</td>
                        <td>₱{purchase.itemTotal.toFixed(2)}</td>
                        <td>{formatDate(purchase.manufacturingDate)}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            ) : (
              <div className="d-flex flex-column justify-content-center align-items-center mt-4">
                <TbDeviceIpadCancel size={100} color="#AAAAAA" />
                <label style={{ color: "#AAAAAA" }}> No data found.</label>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }
  return (
    <>
      <div className="d-flex flex-column">
        <Dropdown onSelect={handleSelect}>
          <Dropdown.Toggle
            id="dropdown-basic"
            variant=""
            style={{
              color: "white",
              backgroundColor: "#10451D",
              fontWeight: "600",
              outline: "none",
            }}
          >
            {selectedOption}
          </Dropdown.Toggle>

          <Dropdown.Menu>
            <Dropdown.Item eventKey="Inventory" style={{ fontWeight: "500" }}>
              Inventory
            </Dropdown.Item>
            <Dropdown.Item eventKey="Sales" style={{ fontWeight: "500" }}>
              Sales
            </Dropdown.Item>
            <Dropdown.Item eventKey="Product" style={{ fontWeight: "500" }}>
              Product
            </Dropdown.Item>
          </Dropdown.Menu>
        </Dropdown>

        <div>
          {selectedOption === "Inventory" && inventoryRep()}
          {selectedOption === "Sales" && salesRep()}
          {selectedOption === "Product" && prodRep()}
        </div>
      </div>

      <Modal
        show={showModalSales}
        onHide={handleModalSalesClose}
        dialogClassName={style["custom-modal"]}
        scrollable
        centered
      >
        <Modal.Header closeButton>
          <Modal.Title>
            <div className={`d-flex align-items-center`}>
              <h3 className={`mr-2`} style={{ fontWeight: "600" }}>
                Preview
              </h3>
            </div>
          </Modal.Title>
        </Modal.Header>

        <Modal.Body>
          <div ref={ref}>
            <div className="d-flex flex-column justify-content-start align-items-center w-100">
              <div
                className="d-flex justify-content-between align-items-center w-100 p-2"
                style={{ backgroundColor: "#eee" }}
              >
                <div className="d-flex align-items-center">
                  <img src={logo} className={style.logo} />

                  <div className="d-flex flex-column ms-2">
                    <h6>Manuel's</h6>
                    <h6>Pharmacy</h6>
                  </div>
                </div>

                <div className="d-flex me-2">
                  <h4 style={{ fontWeight: "600" }}>Sales Report</h4>
                </div>
              </div>
            </div>

            <table
              className={`${style.tblSale} table caption-top table-borderless table-striped`}
            >
              <caption>Date Range: {handleRange}</caption>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Cash</th>
                  <th>Total Sales</th>
                  <th>
                    <div className="d-flex flex-column">
                      <label>Date</label>
                      <label className={style.lblmmddyyyy}>(yyyy/mm/dd)</label>
                    </div>
                  </th>
                </tr>
              </thead>

              <tbody>
                {consolidatedSalesData.map((sale, index) => (
                  <tr key={index}>
                    <td>{sale.saleId}</td>
                    <td>{sale.cash}</td>
                    <td>{sale.totalSale.toFixed(2)}</td>
                    <td>{formatDate(sale.dateSale)}</td>
                  </tr>
                ))}
              </tbody>
            </table>

            <div
              className="d-flex justify-content-end align-items-center  p-2"
              style={{ backgroundColor: "#eee" }}
            >
              <div className="d-flex flex-column">
                <div className="d-flex justify-content-end">
                  <h5>Total Sales:</h5>
                </div>

                <h3 style={{ fontWeight: "600" }}>{totalSale}</h3>
              </div>
            </div>
          </div>

          <div
            className={`${style.prepared} d-flex justify-content-start mx-4 flex-column`}
          >
            Prepared By:
            <input
              type="text"
              value={inputValueS}
              onChange={handleChangeS}
              style={{
                backgroundColor: "#eee",
                border: "none",
                padding: 0,
                margin: 0,
                fontSize: "20px",
              }}
            />
            <h6 style={{ fontWeight: "600", fontSize: "15px" }}>
              <i>Admin</i>
            </h6>
          </div>
        </Modal.Body>

        <Modal.Footer>
          <div className="d-flex justify-content-end align-items-center w-100">
            <ReactToPrint
              trigger={() => (
                <button
                  className="btn btn-success"
                  onClick={handleConfirmS}
                  disabled={isInputEmptyS}
                >
                  Confirm
                </button>
              )}
              content={() => ref.current}
              pageStyle={pageStyle}
            />
          </div>
          {isInputEmptyS && (
            <div style={{ marginLeft: "10px", color: "red" }}>
              <h6 style={{ fontSize: "13px" }}>Enter a name in prepared by.</h6>
            </div>
          )}
        </Modal.Footer>
      </Modal>

      <Modal
        show={showModalInventory}
        onHide={handleModalInventoryClose}
        dialogClassName={style["custom-modal"]}
        scrollable
        centered
      >
        <Modal.Header closeButton>
          <Modal.Title>
            <div className={`d-flex align-items-center`}>
              <h3 className={`mr-2`} style={{ fontWeight: "600" }}>
                Preview
              </h3>
            </div>
          </Modal.Title>
        </Modal.Header>

        <Modal.Body>
          <div ref={ref}>
            <div className="d-flex flex-column justify-content-start align-items-center w-100">
              <div
                className="d-flex justify-content-between align-items-center w-100 p-2"
                style={{ backgroundColor: "#eee" }}
              >
                <div className="d-flex align-items-center">
                  <img src={logo} className={style.logo} />

                  <div className="d-flex flex-column ms-2">
                    <h6>Manuel's</h6>
                    <h6>Pharmacy</h6>
                  </div>
                </div>

                <div className="d-flex me-2">
                  <h4 style={{ fontWeight: "600" }}>Inventory Report</h4>
                </div>
              </div>
            </div>

            <table className={`${style.tblInventory} table caption-top `}>
              <caption>Date Range: {handleRangeInv}</caption>
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Initial Qty</th>
                  <th>Purchased Qty </th>
                  <th>Remaining Qty</th>
                  <th>Price</th>
                  <th>Total Price</th>
                  <th>
                    <div className="d-flex flex-column">
                      <label>Date Purchased</label>
                      <label className={style.lblmmddyyyy}>(yyyy/mm/dd)</label>
                    </div>
                  </th>
                </tr>
              </thead>

              <tbody>
                {filteredSalesInv.map((sale, index) => (
                  <tr key={index}>
                    <td>
                      <div className="d-flex flex-column">
                        <div>
                          <h6 style={{ fontWeight: "600" }}>{sale.saleId}</h6>
                        </div>
                        <div>{`${sale.prodName} (${sale.prodDetails})`}</div>
                        
                      </div>
                    </td>
                    <td>{sale.batchQty || "0"}</td>
                    <td>{sale.qty || "0"}</td>
                    <td>{sale.remainingQty || "0"}</td>
                    <td>{sale.sellingPrice || "0"}</td>
                    <td>{sale.buyingPrice || "0"}</td>
                    <td>{formatDate(sale.dateSale)}</td>
                  </tr>
                ))}
              </tbody>
            </table>

            <div
              className={`${style.prepared} d-flex justify-content-start mx-4 flex-column`}
            >
              Prepared By:
              <input
                type="text"
                value={inputValueI}
                onChange={handleChangeI}
                style={{
                  backgroundColor: "#eee",
                  border: "none",
                  padding: 0,
                  margin: 0,
                  fontSize: "20px",
                }}
              />
              <h6 style={{ fontWeight: "600", fontSize: "15px" }}>
                <i>Admin</i>
              </h6>
            </div>
          </div>
        </Modal.Body>

        <Modal.Footer>
          <div className="d-flex justify-content-end align-items-center w-100">
            <ReactToPrint
              trigger={() => (
                <button
                  className="btn btn-success"
                  onClick={handleConfirmI}
                  disabled={isInputEmptyI}
                >
                  Confirm
                </button>
              )}
              content={() => ref.current}
              pageStyle={pageStyle}
            />
          </div>
          {isInputEmptyI && (
            <div style={{ marginLeft: "10px", color: "red" }}>
              <h6 style={{ fontSize: "13px" }}>Enter a name in prepared by.</h6>
            </div>
          )}
        </Modal.Footer>
      </Modal>

      <Modal
        show={showModalProduct}
        onHide={handleModalProductClose}
        dialogClassName={style["custom-modal"]}
        scrollable
        centered
      >
        <Modal.Header closeButton>
          <Modal.Title>
            <div className={`d-flex align-items-center`}>
              <h3 className={`mr-2`} style={{ fontWeight: "600" }}>
                Preview
              </h3>
            </div>
          </Modal.Title>
        </Modal.Header>

        <Modal.Body>
          <div ref={ref}>
            <div className="d-flex flex-column justify-content-start align-items-center w-100">
              <div
                className="d-flex justify-content-between align-items-center w-100 p-2"
                style={{ backgroundColor: "#eee" }}
              >
                <div className="d-flex align-items-center">
                  <img src={logo} className={style.logo} />

                  <div className="d-flex flex-column ms-2">
                    <h6>Manuel's</h6>
                    <h6>Pharmacy</h6>
                  </div>
                </div>

                <div className="d-flex me-2">
                  <h4 style={{ fontWeight: "600" }}>Product Report</h4>
                </div>
              </div>
            </div>

            <table className={`${style.tblProduct} table caption-top`}>
              <caption>Date Range: {handleRange}</caption>
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Qty</th>
                  <th>Price</th>
                  <th>Total Price</th>
                  <th>
                    <div className="d-flex flex-column">
                      <label>Date Purchased</label>
                      <label className={style.lblmmddyyyy}>(yyyy/mm/dd)</label>
                    </div>
                  </th>
                </tr>
              </thead>

              <tbody>
                {filteredPurchase.map((purchase, index) => (
                  <tr key={index}>
                    <td>
                      <div className="d-flex flex-column">
                        <h6>{purchase.batchNumber}</h6>
                        <h6>{purchase.prodName}</h6>
                        <label>{purchase.prodDetails}</label>
                      </div>
                    </td>
                    <td>{`${purchase.receivedQty} - (${purchase.prodUnitName})`}</td>
                    <td>
                      {purchase.buyingPrice.toLocaleString("en-US", {
                        minimumFractionDigits: 2,
                      })}
                    </td>
                    <td>
                      {purchase.itemTotal.toLocaleString("en-US", {
                        minimumFractionDigits: 2,
                      })}
                    </td>
                    <td>{formatDate(purchase.dateReq)}</td>
                  </tr>
                ))}
              </tbody>
            </table>

            <div
              className="d-flex justify-content-end align-items-center  p-2"
              style={{ backgroundColor: "#eee" }}
            >
              <div className="d-flex flex-column">
                <div className="d-flex justify-content-end">
                  <h5>Total Cost:</h5>
                </div>

                <h3 style={{ fontWeight: "600" }}>{purchaseTotal}</h3>
              </div>
            </div>

            <div
              className={`${style.prepared} d-flex justify-content-start mx-4 flex-column`}
            >
              Prepared By:
              <input
                type="text"
                value={inputValueP}
                onChange={handleChangeP}
                style={{
                  backgroundColor: "#eee",
                  border: "none",
                  padding: 0,
                  margin: 0,
                  fontSize: "20px",
                }}
              />
              <h6 style={{ fontWeight: "600", fontSize: "15px" }}>
                <i>Admin</i>
              </h6>
            </div>
          </div>
        </Modal.Body>

        <Modal.Footer>
          <div className="d-flex justify-content-end align-items-center w-100">
            <ReactToPrint
              trigger={() => (
                <button
                  className="btn btn-success"
                  onClick={handleConfirmP}
                  disabled={isInputEmptyP}
                >
                  Confirm
                </button>
              )}
              content={() => ref.current}
              pageStyle={pageStyle}
            />
          </div>
          {isInputEmptyP && (
            <div style={{ marginLeft: "10px", color: "red" }}>
              <h6 style={{ fontSize: "13px" }}>Enter a name in prepared by.</h6>
            </div>
          )}
        </Modal.Footer>
      </Modal>
    </>
  );
};

export default Sales;
